### Майнор "Графы и Топология". Домашнее задание 1. 

##### Выполнил: Кузнецов Володя БПМИ 188

---

**Задача 1.** Пронумеруем буквы русского алфавита числами от 1 до 33. Напишите слитно Ваши имя и фамилию, оставьте только первые шесть букв и замените каждую букву числом от одного до восьми, равным номеру буквы по модулю восемь. Мы получили последовательность, состоящую из шести чисел от одного до восьми. Нарисуйте дерево на восьми пронумерованных вершинах с таким кодом Прюфера.

---

Так как задача построенна некорректно: область возможных значений операции "взятие по модулю восемь" – числа от нуля до семи, я считаю нужным уточнить, что придерживаюсь следующего правила: вместо простого взятия по модулю восемь, я буду брать модуль и прибавлять единицу к получившемуся числу. 

ВладимирКузнецов $\to$ Владим $\to 3, 13, 1, 5, 10, 14 \to 4, 6, 2, 6, 3, 7$. Получили $462637$.

*Первый шаг*:<br>
Код Прюфера: 4 6 2 6 3 7,<br>
Массив вершин дерева: 1 2 3 4 5 6 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $1$,<br>
Список ребер: 1 4.

*Второй шаг*:<br>
Код Прюфера: **4** 6 2 6 3 7,<br>
Массив вершин дерева: **1** 2 3 4 5 6 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $4$,<br>
Список ребер: 1 4, 4 6.

*Третий шаг*:<br>
Код Прюфера: **4 6** 2 6 3 7,<br>
Массив вершин дерева: **1** 2 3 **4** 5 6 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $5$,<br>
Список ребер: 1 4, 4 6, 5 2.

*Четвёртый шаг*:<br>
Код Прюфера: **4 6 2** 6 3 7,<br>
Массив вершин дерева: **1** 2 3 **4 5** 6 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $2$,<br>
Список ребер: 1 4, 4 6, 5 2, 2 6.

*Пятый шаг*:<br>
Код Прюфера: **4 6 2 6** 3 7,<br>
Массив вершин дерева: **1 2** 3 **4 5** 6 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $6$,<br>
Список ребер: 1 4, 4 6, 5 2, 2 6, 3 6.

*Шестой шаг*:<br>
Код Прюфера: **4 6 2 6 3** 7,<br>
Массив вершин дерева: **1 2** 3 **4 5 6** 7 8,<br>
Минимальная вершина, не содержащаяся в коде Прюфера – это $3$,<br>
Список ребер: 1 4, 4 6, 5 2, 2 6, 3 6, 3 7.

*Завершение алгоритма*:<br>
Код Прюфера: **4 6 2 6 3 7**,<br>
Массив вершин дерева: **1 2 3 4 5 6** 7 8,<br>
Список ребер: 1 4, 4 6, 5 2, 2 6, 3 6, 3 7, 7 8.

Рисуночек:

<img src="/Users/cdraugr-/Desktop/HSE/MathStructs/GraphsAndTopology/HomeAssignment1/images/image1.png" style="zoom:30%;" />

---

**Задача 2.** Найдите хроматический многочлен полного двудольного графа $K_{2, 3}$.

---

<img src="/Users/cdraugr-/Desktop/HSE/MathStructs/GraphsAndTopology/HomeAssignment1/images/image2.png" style="zoom:50%;" />

Итого имеем:
$$
\begin{multline*}
\chi_{K_{2, 3}}(x) = \chi_{K_{5}}(x) + 3\chi_{K_{4}}(x) + \chi_{K_{3}}(x) + x(x-1)^3 = \\
x(x-1)(x^3-5x^2+10x-7) = \\
x^5-6x^4+15x^3-17x^2+7x.
\end{multline*}
$$
Я скрыл никому ненужные упрощения, они не играют тут никакой важной роли.<br>Лишь отмечу, что $\chi_{K_n}(x) = x(x-1)\ldots(x-n+1)$.

---

<div style="page-break-after: always;"></div>

**Задача 3.** Определите, какие из следующих графов являются попарно изоморфными.

---

Пронумеруем графы слева направо сверху вниз числами от одного до десяти.<br>Теперь отметим, что некоторые графы сразу можно не рассматривать из-за разного рода вещей: в некоторых графах у некоторых вершин степени больше или меньше четырёх (при этом попарно не совпадает), в графе больше 16 рёбер (в $8$ из $10$ их $16$). Так можем сразу откинуть 4, 6, 7 (они не изоморфны между собой). Дальше замечаем, что графы 2, 3, 9 – $K_{4, 4}$, в 9 это видно просто, а в 2 и 3 заметны "прямоугольники" из рёбер, других $K_{4, 4}$ тут нет. Дальше рассматриваем только 1, 5, 8 и 10. Первые три попарно изоморфны между собой (методом пристального взгляда), десятый нет (по макс. клике). Так же для проверки всех моих рассуждений выше, был написан [код](https://gist.github.com/cdraugr/71bc9c29c8091e7932e1d9d72b2a8036), который всё это подтвердил. 

---

**Задача 4.** Ориентацией графа называется выбор направлений в нём. Ориентация называется ациклической, если в графе отсутствуют простые циклы, идущие в направлении ориентированных рёбер. Докажите, что число ациклических ориентаций в графе $G$ равно $|\chi_G(-1)|$, где $\chi_G(c)$ – это хроматический многочлен графа $G$.

---

$\triangleright\quad$ Для начала поймём, что в силу знакопеременности коэффициентов $\chi_G$ и положительности коэффициента перед старшим членом имеем, что $|\chi_G(-1)| = (-1)^n\chi_G(-1)$, где $n$ – число вершин в графе. Тогда докажем, что число ациклических ориентаций в графе $G$ равно $(-1)^n\chi_G(-1)$. Так же введём $f(G)$ – число ациклических ориентаций графа $G$.

Для пустых графов равенство очевидно, так как там лишь одна ориентация, которая и будет ациклической.<br>Теперь давайте вопользуемся математической индукцией по числу рёбер. Если мы докажем рекурентную формулу:
$$
f(G) = f(G-e) + f(G/e),
$$
где $e = uv$ – ребро графа $G$, то если формула верна для всех графов с меньшим числом рёбер, то:
$$
\begin{multline*}
f(G-e) + f(G/e) = (-1)^n\chi_{G-e}(-1) + (-1)^{n-1}\chi_{G/e}(-1) =\\
=(-1)^n(\chi_{G-e}(-1) - \chi_{G/e}(-1)) = (-1)^n\chi_G(-1).
\end{multline*}
$$
Последний переход верен в силу формулы "удаления – стягивания" для хроматического многочлена. Осталось доказать рекурентное разложение $f(G)$.<br>Давайте рассмотрим ациклические ориентации графа $G-e$, их можно разбить на два типа: между $u$ и $v$ есть путь и между $u$ и $v$ нет пути. Положим, что первых $x$, а вторых $y$. Теперь поймём, что $f(G/e) = y$, так как после стягивания ребра $e$ ориентации графа $G-e$, в которых нет пути между $u$ и $v$ останутся ациклическими. Получаем, что $f(G-e) + f(G/e) = x + 2y$. При этом ациклические ориентации $G − e$, в которых между $u$ и $v$ есть путь, единственным образом дополняются до ориентации $G$ (надо ориентировать ребро $e$ так же, как этот путь), а те, в которых пути между $u$ и $v$ нет — двумя способами (ориентируем ребро $e$ как угодно), т.е. $f(G) = x + 2y$. Имеем $x+2y = x+2y$. $\quad\square$

---

**Задача 5.**  Замыканием $C(G)$ графа $G$ называется граф, полученный из $G$ поледовательным соединением в нём рёбрами пар несмежных между собой вершин, сумарные степени которых больше или равны $n = |V(G)|$, до тех пор пока ни одной такой пары не останется.

**а)** Докажите, что граф $C(G)$, полученный в результате замыкания графа $G$, не зависит от порядка выбора рёбер, соединяющих несмежные вершины в графе $G$.

**б)** Докажите, что граф $G$ является гамильтоновым тогда и только тогда, когда его замыкание $C(G)$ является гамильтоновым. 

---

**а)** $\triangleright\quad$ Если честно, то я не фанат доказывать очевидные утвердения (уж простите), так что качество этого может немного проседать.

Обозначим $d_G(v)$ – степень вершины $v$ в графе $G$.<br>Пусть в результате двух замыканий графа $G$ мы получили два различных замыкания $G_1$ и $G_2$. Рассмотрим первое различное добавление нового ребра. Перед этим добавлением графы были одинаковыми, обозначим это состояние за $G_0$. Пусть в первом процессе мы добавили ребро $u_1v_1$, а во втором процессе ребро $u_2v_2$. Это значит, что
$$
d_{G_0}(v_1) + d_{G_0}(u_1) \geq n, d_{G_0}(v_2) + d_{G_0}(u_2) \geq n,
$$
а значит оба ребра будут добавлены в обоих процессах замыкания. Аналогичные рассуждения можем проделать с последующими различиями (но уже держа в голове, что $u_1v_1$ и $u_1v_2$ точно будут в обоих графах). $\quad\square$

**б)** $\triangleright\quad$ Вспомним, что гамильтонов граф – граф, содержащий гамильтонов цикл, а значит:

1. Граф $G$ является гамильтоновым $\Rightarrow$ его замыкание $C(G)$ является гамильтоновым.<br>$\triangleright\quad$ Так как в процессе замыкания мы ничего не удаляем из графа, а только добавляем, то в эту сторону очевидно в силу построения замыкания графа (если там был гамильтонов цикл, то он никуда не денется). $\quad\square$

2. Замыкание $C(G)$ графа является гамильтоновым $\Rightarrow$ граф $G$ является гамильтоновым.

   $\triangleright\quad$ **Лемма.** Пусть $uv \notin E(G)$, при этом $d_G(u) + d_G(v) \geq |V(G)|$, тогда граф $G$ является гамильтоновым тогда и только тогда, когда граф $G + uv$ является гамильтоновым.

   $\triangleright\quad$ В одну сторону очевидно (аналогично п.1). Т.е. если граф был гамильтоновым, то добавление к нему какого-либо ребра не может сделать из него не гамильтоновой граф.

   Пусть граф $G+uv$ гамильтонов, тогда: Если гамильтонов цикл не проходит через ребро $uv$, то этот цикл есть в графе $G$. Если гамильтонов цикл проходит через ребро $uv$, то в графе $G$ есть гамильтонов путь с концами $u$ и $v$. Тогда имеем некоторый путь $a_1\ldots a_n$ длины $n$ в исходном графе. При этом $a_1$ несмежна с $a_n$. Пусть вершина $a_1$ смежна с $a_{k+1}$, а $a_n$ смежна с $a_{k}$ (такое $k$ найдётся в силу $d_G(u) + d_G(v) \geq |V(G)|$), тогда в графе есть цикл $a_1\ldots a_{k} a_n a_{n-1} \ldots a_{k+1}$. Получили, что $G$ является гамильтоновым. $\quad\square$

   Из этой леммы явно вытекает п.2. $\quad\square$

Утверждение доказано в обе стороны. $\quad\square$

---